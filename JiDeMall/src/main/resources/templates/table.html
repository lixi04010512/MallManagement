<!doctype html>
<html class="no-js" lang="" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Ela Admin - HTML5 Admin Template</title>
    <meta name="description" content="Ela Admin - HTML5 Admin Template">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" href="/images/QRAUqs9.png">
    <link rel="shortcut icon" href="/images/QRAUqs9.png">

    <link rel="stylesheet" href="/stylesheets/normalize.min.css">
    <link rel="stylesheet" href="/stylesheets/bootstrap.min.css">
    <link rel="stylesheet" href="/stylesheets/font-awesome.css">
    <link rel="stylesheet" href="/stylesheets/themify-icons.css">
    <link rel="stylesheet" href="/stylesheets/pe-icon-7-stroke.min.css">
    <link rel="stylesheet" href="/stylesheets/flag-icon.min.css">
    <link rel="stylesheet" href="/stylesheets/cs-skin-elastic.css">
    <link rel="stylesheet" href="/stylesheets/dataTables.bootstrap.min.css">
    <link rel="stylesheet" href="/stylesheets/style2.css">
    <link rel="stylesheet" href="/stylesheets/backstage.css">
    <link href='/stylesheets/css.css' rel='stylesheet' type='text/css'>
    <link href="/stylesheets/turnover.css" rel="stylesheet">
    <script src="/javascripts/jq.js"></script>
</head>

<body>

<aside id="left-panel" class="left-panel">
    <nav class="navbar navbar-expand-sm navbar-default">

        <div id="main-menu" class="main-menu collapse navbar-collapse">
            <ul class="nav navbar-nav">
                <li class="menu-item-has-children active dropdown" style="width: 280px;">
                    <a href="/users/table_html" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"
                       aria-expanded="false"> <i class="menu-icon fa fa-table"></i>商品管理</a>

                </li>

            </ul>
        </div>
    </nav>
</aside>

<div id="right-panel" class="right-panel">

    <header id="header" class="header">
        <div class="top-left">
            <div class="navbar-header">
                <a class="navbar-brand">JIDE</a>
                <a class="navbar-brand hidden"><img src="/images/logo2.png" alt="Logo"></a>
                <a id="menuToggle" class="menutoggle"><i class="fa fa-bars"></i></a>
            </div>
        </div>
    </header>

    <div class="content">
        <div class="animated fadeIn">

            <div class="row">

                <div class="col-xl-6 col-sm-6">
                    <div class="card">
                        <div class="card-body px-4 pb-0">
                            <h4 class="fs-18 font-w600 mb-5 text-nowrap">历史营业额</h4>
                            <div class="progress default-progress">
                                <div class="progress-bar bg-gradient progress-animated" style="width: 40%; height:10px;" role="progressbar">
                                    <span class="sr-only">45% Complete</span>
                                </div>
                            </div>
                            <div class="d-flex align-items-end mt-2 pb-3 justify-content-between">
                                <span>76 left from target</span>
                                <h4 class="mb-0" id="turnover_history"></h4>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xl-6 col-sm-6" style="padding-left: 328px; margin-top: 20px;">
                    <div class="card" style=" width: 200px;padding-left: 28px;">
                        <div class="card-body d-flex px-4 pb-0 justify-content-between">
                            <div>
                                <h4 class="fs-18 font-w600 mb-4 text-nowrap">今日营业额</h4>
                                <div class="d-flex align-items-center">
                                    <h2 class="fs-32 font-w700 mb-0" id="turnover_today"></h2>
                                    <span class="d-block ms-4">
									<svg width="21" height="11" viewbox="0 0 21 11" fill="none" xmlns="http://www.w3.org/2000/svg">
										<path d="M1.49217 11C0.590508 11 0.149368 9.9006 0.800944 9.27736L9.80878 0.66117C10.1954 0.29136 10.8046 0.291359 11.1912 0.661169L20.1991 9.27736C20.8506 9.9006 20.4095 11 19.5078 11H1.49217Z" fill="#09BD3C"></path>
									</svg>
									<small class="d-block fs-16 font-w400 text-success">+0,5%</small>
								</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            <strong class="card-title">商品列表</strong>
                            <a id="add" href="/users/add_html" style="background-color: #6e6e6e;
                                border: none;
                                color: white;
                                padding: 5px 7px;
                                text-align: center;
                                text-decoration: none;
                                display: inline-block;
                                font-size: 16px;margin-left: 10px;">添加商品</a>

                                <div class="card-body">
                                    <table id="bootstrap-data-table" class="table table-striped table-bordered">
                                        <thead>
                                        <tr>
                                            <th>图片</th>
                                            <th>编号</th>
                                            <th>名称</th>
                                            <th>类别</th>
                                            <th>详情</th>
                                            <th>价格</th>
                                            <th>销量</th>
                                            <th>库存</th>
                                            <th>上架时间</th>
                                            <th>操作</th>
                                        </tr>
                                        </thead>
                                        <tbody id="content">
                                        <tr th:each="product:${products}" th:attr="datakey = ${product.productId}">
                                            <td class="img">
                                                <img th:src="${product.productImg}"/>
                                            </td>
                                            <td th:text="${product.productId}"></td>
                                            <td th:text="${product.productName}"></td>
                                            <td th:text="${product.categoryId}"></td>
                                            <td th:text="${product.details}"></td>
                                            <td th:text="${product.price}"></td>
                                            <td th:text="${product.salesCount}"></td>
                                            <td th:text="${product.inventory}"></td>
                                            <td th:text="${product.createTime}"></td>
                                            <td>
                                                <button style="background-color: #6e6e6e;
                                                    border: none;
                                                    color: white;
                                                    padding: 2px 6px;
                                                    text-align: center;
                                                    text-decoration: none;
                                                    display: inline-block;
                                                    font-size: 16px;
                                                    margin-left: 7px;" class="cha" th:data-id="${product.productId}">编辑</button>
                                                <button style="background-color: #6e6e6e;
                                                    border: none;
                                                    color: white;
                                                    padding: 2px 6px;
                                                    text-align: center;
                                                    text-decoration: none;
                                                    display: inline-block;
                                                    font-size: 16px;
                                                    margin-left: 7px;    margin-top: 8px;" class="del" th:data-id="${product.productId}">删除</button>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                        </div>

                    </div>
                </div>
            </div>

            <div class="clearfix"></div>
        </div>
    </div>

</div>
</body>
<script src="/javascripts/jq.js"></script>
<script src="/javascripts/popper.min.js"></script>
<script src="/javascripts/bootstrap.min.js"></script>
<script src="/javascripts/jquery.matchHeight.min.js"></script>
<script src="/javascripts/main1.js"></script>
<script src="/javascripts/datatables.min.js"></script>
<script src="/javascripts/dataTables.bootstrap.min.js"></script>
<script src="/javascripts/dataTables.buttons.min.js"></script>
<script src="/javascripts/buttons.bootstrap.min.js"></script>
<script src="/javascripts/jszip.min.js"></script>
<script src="/javascripts/vfs_fonts.js"></script>
<script src="/javascripts/buttons.html5.min.js"></script>
<script src="/javascripts/buttons.print.min.js"></script>
<script src="/javascripts/buttons.colVis.min.js"></script>
<script src="/javascripts/datatables-init.js"></script>
<script src="/javascripts/product.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        $('#bootstrap-data-table-export').DataTable();
    })

    $("#content").delegate(".del","click",function(){
        console.log($(this).data("id"));
            $.ajax({
                type:"DELETE",
                url:"/admin/products/deleteProduct/"+$(this).data("id"),
                success:function (){
                    location.reload();
                }
            })
    })

    $("#content").delegate(".cha","click",function(){
            window.location="/admin/products/findProductById1/"+$(this).data("id");
    })

    $.get("/admin/order/queryToday",function(data){
        var turnover_today = 0
        if (data.data.length != 0) {
            for (const i in data.data) {
                console.log(data.data[i].sumPrice);
                turnover_today+=data.data[i].sumPrice
            }
        }

        $("#turnover_today").text(turnover_today)
    })

    $.get("/admin/order/queryHistory",function(data){
        var turnover_history = 0
        if (data.data.length != 0) {
            for (const i in data.data) {
                console.log(data.data[i].sumPrice);
                turnover_history+=data.data[i].sumPrice
            }
        }

        $("#turnover_history").text(turnover_history)
    })

</script>
</body>

</html>